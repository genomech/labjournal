# Обработка экзомных данных

## Протокол

### Оценка качества входных данных (*FastQC*)

	* Размер последовательностей: >=8 букв
	* Сверхрепрезентированные последовательности: отсутствуют

### Выравнивание (*bowtie2*, *bwa*)

	* Убрать неканонические хромосомы из bed-файла
	
### Анализ качества выравниваний (*BamQC*? Свои скрипты?)

	* Доля выравненных последовательностей: >80%
	* Доля дупликатов в экзонах: <30%

### Удаление дупликатов (*PicardTools*)

### Оценка качества после удаления дупликатов

	* Обогащение: >10X

	**TODO:** Mapped reads делить на Regions size/percentage of reference должно быть >10X. Но сначала нужно понять, почему у нас не сходятся данные, полученные нашим скриптом, с этой оценкой.

	* Покрытие 95%: >=10
	* Среднее покрытие: >= 70 

	**TODO:** узнать, what they mean, middle or median.

### Идентификация вариантов (*GATK*, *freebayes*).

	* Left realignment: *freebayes* делает это по умолчанию, но авторы протокола советуют делать это перед *freebayes*. 

	**TODO:** Уточнить почему.

	* Skip-limit (skip regions of extremely high coverage): стартовое значение 200 (уточнить по ходу работы).
	* Миниальная доля альтернативных аллелей для гетерозигот: 0.25
	* QUAL: начать с 18, подстраивать под контрольные метрики из предыдущих пунктов.

	**TODO:** freebayes выдает значения QUAL, которые означают "надежность" найденного варианта. В файл пишутся все варианты, но их нужно фильтровать. Можно стартовать с QUAL >20, но надо уточню, какие значения используют другие.

	* DP для идеальных данных (см. контроль качества выше): >12-15.
	* DP при среднем покрытим <70: >8-10.
	* DP при анализе конкретного гена: не учитывать.

### Разбиение многобуквенных замен на однобуквенные (*vcfallelicprimitives*)

	**TODO:** Узнать, что происходит с параметрами vcf при разбиении.

### Аннотация вариантов (*Annovar*, *Ensembl VEP*)

	**TODO:** Стоит ли нам мигрировать на Annovar?
	
	1. Нужно отмечать главную (каноническую) изоформу. В *Ensembl VEP* есть опция, нужно поискать, в *Annovar* это по дефолту. 
	2. В *Ensembl VEP* полезно включать low complexity filter. Нужно найти его и проверить, включен ли он у нас.
	3. *Annovar* пишет в файл все варианты, уже потом их фильтрует по значимости.

### Поиск по таблице

	* Отбор по частоте в популяционных данных (берём максимальную из всех БД, но в процессе анализа смотрим данные по всем).
		* Если частое аутосомно-рецессивное заболевание: частота по БД <5%.
		* Если редкое: <0.05-0.5%. 
		* Нижняя граница частоты: 0.01%. При анализе всегда берётся чуть выше.

	**TODO:** Нужно проверить, почему в наших таблицах не всегда совпадают частоты с указанными в БД, если это глюк *Ensembl VEP*, перейти на *Annovar*. Пример: PRODH (HGMD) - нет частоты. В других БД частота высокая, в 1000 геномов, например.

	* Поиск вариантов
		* Поиск loss-of-function variants: frameshift, stop codon, splice-site.
		* Если ничего не нашлось, ищем missence.

### Проверка найденного

	* Проверка сырых данных в bam-файле (не последний ли/первый/альтернативный экзон).
	* Перепроверка частот в популяции по разным БД.
	* GnomAD/ExAC loss-of-function intolerant (pLI) score для гена. Сверять с мышиными фенотипами, литературой и проч.
	* HGMD. Описана ли в этой позиции другая замена и какой её эффект.
	* ClinVar. Ей доверия меньше, поэтому после остальных.
	* OMIM. Сравнение известного фенотипа с фенотипом по БД.
	* SIFT, PolyPhen и пр.: предсказание эффекта.

### Прочие особенности анализа

	* Если есть подозрение на ограниченный список генов, сначала анализируются варианты в этих генах.
	* Если нет: полный анализ.

## Требуемая информация по мутации

* Референсный аллель
* Замена
* Плоидность
* QUAL (*freebayes*)
* Имя гена
* Импакт
* Максимальная частота встречаемости из всех БД, частоты по разным БД

**TODO:** Мне кажется, что присутствие мутации в одной БД и отсутствие в прочих _подозрительно_.
Мне кажется, отдельным пунктом надо отмечать присутствие мутации в разных БД и разброс по частотам.

* pLI-score
* OMIM
* HGMD
* ClinVar
* Номер экзона, общее число экзонов
* DP: суммарное + для каждого из вариантов, если гетерозигота
* Координата (сортировка)

**TODO:** Спросить, почему координата не в начале таблицы.

* Все остальные данные, в т.ч. данные программ, предсказывающих эффекты сплайсинга, замен АК, etc.

## Ссылки

1. [Калькулятор патогенности вариантов нуклеотидной последовательности](http://calc.generesearch.ru/)
